<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flight Results - Flight Price Tracker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <nav class="navbar">
          <div class="nav-container">
              <a href="/" class="nav-brand">✈️ Flight Tracker</a>
              <div class="nav-links">
                  <a href="/">Home</a>
                  <a href="/alerts">Alerts</a>
              </div>
          </div>
      </nav>

    <div class="results-container">
        <div class="search-summary">
            <h1>Flight Results</h1>
            <p>{{ origin }} → {{ destination }}</p>
            <p>{{ departure_date }}{% if return_date %} - {{ return_date }}{% endif %}</p>
            <p>{{ total_passengers }} passenger(s)</p>
        </div>

            <div class="results-search-bar">
                <a href="/" class="back-btn">← Go Back</a>

                <form action="/search" method="POST" class="inline-search-form">
                    <div class="inline-field">
                        <label for="results-origin">Origin Airport</label>
                        <input type="text" name="origin" id="results-origin" placeholder="e.g., LAX" value="{{ origin }}" required>
                    </div>

                    <div class="inline-field">
                        <label for="results-destination">Destination Airport</label>
                        <input type="text" name="destination" id="results-destination" placeholder="e.g., NRT" value="{{ destination }}" required>
                    </div>

                    <div class="inline-field">
                        <label for="results-departure">Departure Date</label>
                        <input type="date" name="departure_date" id="results-destination" value="{{ departure_date }}" required>
                    </div>
                    {% if trip_type == 'round-trip' %}
                        <div class="inline-field">
                            <label for="results-return">Return Date</label>
                            <input type="date" name="return_date" id="results-return" value="{{ return_date }}" required>
                        </div>
                    {% endif %}

                    <!-- Hidden filds to preserve other form data -->
                    <input type="hidden" name="trip_type" value="{{ trip_type }}">
                    <!-- might have to fix this line 42-44 -->
                    <input type="hidden" name="adults" value="1">
                    <input type="hidden" name="children" value="0">
                    <input type="hidden" name="infant" value="0">

                    <button type="submit" class="search-btn">Search</button>
                </form>
            </div>

        {% if flights %}

            <div class="flight-count">
                {{ flights|length }} flight(s) found
            </div>

            <div class="flights-list">
                {% for flight in flights %}
                {% if loop.index0 >= 5 %}
                <div class="flight-card hidden" data-flight-index="{{ loop.index0 }}">
                {% else %}
                <div class="flight-card" data-flight-index="{{ loop.index0 }}">
                {% endif %}
                    <div class="flight-header">
                        <div class="airline">{{ flight.airline }}</div>
                        <div class="price">${{ flight.price }}</div>
                    </div>

                    <div class="flight-details">
                        <div class="route">
                            <div class="departure">
                                <strong>{{ flight.origin }}</strong>
                                <p>{{ flight.depart_date }}</p>
                            </div>
                            <div class="arrow">→</div>
                            <div class="arrival">
                                <strong>{{ flight.destination }}</strong>
                                <p>{{ flight.return_date if flight.return_date else 'One-way' }}</p>
                            </div>
                        </div>

                        <div class="flight-info">
                            {% if flight.transfers == 0 %}
                                <span class="badge direct">Direct</span>
                            {% else %}
                                <span class="badge">{{ flight.transfers }} stop(s)</span>
                            {% endif %}

                            {% if flight.duration %}
                                <span>Duration: {{ flight.duration }} min</span>
                            {% endif %}
                        </div>
                    </div>

                    {% if flight.link %}
                        <a href="{{ flight.link }}" target="_blank" class="book-button">Book Now</a>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% if flights|length > 5 %}
            <div class="show-more-container">
                <button id="showMoreBtn" class="show-more-btn">Show More</button>
            </div>
            {% endif %}
        {% else %}
            <div class="no-results">
                <p>No flights found for this route and date.</p>
            </div>
        {% endif %}
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
    
</body>
</html>